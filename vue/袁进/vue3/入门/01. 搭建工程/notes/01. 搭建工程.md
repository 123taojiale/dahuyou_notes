# 01. 搭建工程 {ignore}

[toc]

### 前言

- 时长：

### vue2、vue3

- 在学习 vue3 之前，为何要先学 vue2？

又回到最初的问题，这个问题在学习 vue2 的入门阶段有提到过。

1. Vue3 刚推出来不久，生态还没成熟，很多公司不会直接将其应用到项目中；
1. 市面上还是有很大一部分的项目是使用 Vue2 来开发的，我们之后到了公司后，可能还得维护之前的项目，那很可能就会用到 Vue2；
1. 学会 Vue2 再去看 Vue3，会更容易上手一些；

上面这 3 点是当时在学习 vue2 入门时，对于该问题的回答。

- 补充

下面再补充一些要点：

vue2 升级到 vue3，它并**不是完全兼容式的升级**。也就是说，有一些写法，我们只能在 vue2 中使用，但是在 vue3 中，不能这么用。当然，这里说的是“不完全”，其实还是有很多地方是兼容过去 vue2 的写法的。所以，对于 vue3 的学习，我们需要对比它和 vue2 都有哪些不同，因此 vue2 自然就成了我们需要必学的前置知识了。

就笔者目前（2021年10月）所在的实习单位，参与的项目，虽然使用的是 vue3，但是写法还是使用原来 vue2 的写法，像是 vue3 中的一些 composition api 压根就没用到。可能在项目开始时，vue3 的一些东西还不成熟，所以在组件写法上，都还是使用 vue2 的语法来写。

以上提到的是没有变化的点，就是组件的写法上，和 vue2 几乎一致，使用配置式的写法。当然，也有一些变化的地方，比如：在组件的写法上，vue3 也可以不采用原来 vue2 的配置式写法，而采用函数式写法。具体有哪些变化，也就是我们后面学习 vue3 时的重点内容，而这些变化的点，在学习 vue3 时，再慢慢体会便是。

### 项目升级

- vue3 实践

在学习完本套 vue3 的课程后，尝试将个人博客（使用 vue2 写的）升级到 vue3。使用 vue3 中新推出的 vite 构建工具来搭建工程，将原先的 options api 都改为 composition api。

### composition api

- 简单了解一下 composition api

composition api，又叫组合式 api，它也是本课程的学习重点。composition api 可以算是 vue2 升级到 vue3 最大的变动了，它有点类似于 react 中的 hooks。但是，它们的实现方式、使用体验，是完全不一样的。至于它们哪个更好用，各说风云（袁老感觉 vue 的composition api 会比 react 的 hooks 好用一些。），由于还没有学过 react，只能在学习完 react 部分时，在对比了。

- composition api 如何学习？

袁老视频中提供的方案是使用 composition api 来做一个 TODO MVC 的小demo。完成后，composition api 的基本用法，也就掌握了。

学习过程中，结合[官方文档](https://v3.cn.vuejs.org/api/composition-api.html)来看。

### vue-cli 和 vite

- 简单了解一下 vite

尤雨溪在将 vue2 升级到 vue3 时，除了升级了一下构建工具 vue-cli 之外，它还给我们提供了一个新的构建工具 vite。

我们也使用 vite 这个构建工具来搭建我们的工程，而且 vite 不仅仅可以搭建 vue 工程，还可以搭建 react 工程、多页应用程序，等等。

vite 的最大特点：快。

vue-cli 内部使用的是 webpack 来实现搭建我们的 vue 工程的。但是，它搭建工程的过程很慢。

> vite 是一个法语，含义：快。
> vite 的原理，在 vue3 的就业阶段会介绍，在 vue3 的入门阶段，我们只要知道如何使用 vite 即可。

- 如何使用 vite 来搭建 vue 工程？

```shell
npm init vite-app vue3-vite-app
```

使用 `npm init` 命令下载 `vite-app` 来帮我们搭建一个名为 `vue3-vite-app` 的 vue 工程。

在工程搭建完成后，`vite-app` 会被自动被卸载，这样就能保证每次运行该命令时，都是使用最新的 vite 来搭建工程。

我们也可以全局安装 vite-app，但是没这个必要。

注意：使用 vite 搭建的工程，一开始是没有帮我们安装好相关的依赖的，在工程搭建完成后，我们还得执行 `npm i` 来手动安装一下相关依赖。

![20211013120838](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20211013120838.png)

- vite 工程的启动命令默认为 `npm run dev`

最后就是启动我们搭建的工程了。先看一下 package.json 文件中的 script 字段：

```json
"scripts": {
  "dev": "vite",
  "build": "vite build"
},
```

会发现，启动工程的命令不再是 `npm run serve` 了，而变成了 `npm run dev`。所以，我们使用 vite 搭建的工程，在工程搭建完成后，它的默认启动命令变为不再是原来的 `npm run serve` 了，而变成了 `npm run dev`。

- 启动速度

我们可以对比一下 vite 搭建的工程和 vue-cli 搭建的工程的启动速度，会发现 vite 明显要比 vue-cli 快很多。而且，工程越庞大，差距越明显。当工程量很大时，vue-cli 搭建的工程的启动速度会明显减慢，因为依赖的东西变多了。但是，vite 搭建的工程，启动速度几乎不会发生变化，启动速度还是和初始化时差不多。

- 工程的启动端口默认为 3000。

`http://localhost:3000/`

下面我们在做 TODO MVC 这个 demo 时，也会使用最新的 vite 来搭建我们的工程。

- vite 工程，在导入文件时，除了 `.js` 的文件之外，其它文件，我们都得把后缀名给加上，否则识别不了。

```js
import { createApp } from 'vue'
import App from './App.vue'
// import App from "./App" 若使用这种方式，将无法导入 App.vue
import './index.css'

createApp(App).mount('#app')
```

比如在这个 main.js 文件中，我们在导入 App.vue 时，就不能再像之前那样省略后缀 `.vue` 了，需要把后缀名也给加上才行。

- index.html 文件的位置

index.html 这个页面文件的位置，与 vue-cli 搭建的 vue 工程不同。vue-cli 中 index.html 文件是位于 public 目录下的，而 vite 是位于根目录下的。

![20211013122452](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20211013122452.png)

![20211013122457](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20211013122457.png)

- vite 和 vue-cli 的打包结果

打包命令默认都是 `npm run build`，这一点它们是相同的，但是它们的打包结果存在一些细微的差异。下面是两者的大打包结果：

![20211013122925](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20211013122925.png)

![20211013122935](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20211013122935.png)

这些差异，我们简单了解一下就可以了，重点在于 vite 的使用，以及就业阶段的 vite 实现原理。