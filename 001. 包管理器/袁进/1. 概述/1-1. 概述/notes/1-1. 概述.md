# 1-1. 概述 {ignore}

[toc]

## 前言

本门课程的前置知识：JavaScript、ES6、模块化、git。

本门课程的所有代码均书写在 nodejs 环境中，不涉及浏览器环境（浏览器环境当然也需要包管理器，在后续构建工具课程中会讲解如何实现）。

```
【课程性质】
  面试的时候，一般不会考察包管理器相关的问题，因为它很简单（比模块化简单）。
  该课程是后续很多课程的基础，所以必须掌握。
```

## 1. 概念

**模块（module）**

通常以单个文件形式存在的功能片段，入口文件通常称之为**入口模块**或**主模块**。

**库（library，简称lib）**

以一个或多个模块组成的完整功能块，为开发中某一方面的问题提供完整的解决方案。

**包（package）**

包含元数据的库，这些元数据包括：名称、描述、git主页、许可证协议、作者、依赖等等。

![20210602145706](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20210602145706.png)

**小结**

- 什么是模块？

一个模块就是一个文件，是一个功能片段，可以实现一个小功能。

- 什么是入口模块？

入口模块就是入口文件，也称为主模块。

- 什么是库？

由多个模块组合而成的一个完整功能块，一般针对开发中的某些特定问题提供完整的解决方案，比如：jQuery主要用于简化DOM操作繁琐的问题，mockjs用于模拟后端传递给咋们的数据，等等。

- 什么是包？

包就是包含一些元数据的库。

- 什么是元数据？

名称、描述、git主页、许可证协议、作者、依赖等等。

这一部分，我们只要知道什么是 `module`、`library`、`package` 即可。库和包的概念都差不多，可以把它们看作是一个东西，没必要死扣概念区分它们。

## 2. 背景

**了解相关背景的目的：**

下面所介绍的这些背景信息，目的就是让我们知道：
- 为什么要有包管理器？
- 如果没有它会出现哪些问题？
- 我们为什么要学习包管理器？

**相关背景：**

CommonJS 的出现，使 node 环境下的 JS 代码可以用模块更加细粒度的划分。一个类、一个函数、一个对象、一个配置等等均可以作为模块，这种细粒度的划分，是开发大型应用的基石。

为了解决在开发过程中遇到的常见问题，比如加密、提供常见的工具方法、模拟数据等等，一时间，在前端社区涌现了大量的第三方库。这些库使用 CommonJS 标准书写而成，非常容易使用。

然而，在下载使用这些第三方库的时候，遇到难以处理的问题：

- **下载过程繁琐**。
  - 进入官网或 github 主页
  - 找到并下载相应的版本
  - 拷贝到工程的目录中
  - 如果遇到有同名的库，需要更改名称
- **如果该库需要依赖其他库，还需要按照要求先下载其他库**。
  - 不同的库，也许会依赖相同的库a，那相同的库就要重复下载。
- **开发环境中安装的大量的库如何在生产环境中还原？又如何区分哪些库是开发环境中所需要的，哪些库是生产环境中所需要的？**
- **更新一个库极度麻烦**。
- **自己开发的库，如何在下一次开发使用**。

以上问题，就是包管理工具要解决的问题。（为了解决上面提到的这些难以处理的问题，所以出现了包管理器这个东西。）

**包管理工具出现之前的做法**

一般我们在开发的时候，都会创建一个名为 `lib` 或 `packages` 的目录，该目录下存放的就是这个项目中需要使用到的一些第三方库，一个库一个文件夹，一个库一个文件夹地存放在目录里。

![20210602173356](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20210602173356.png) ![20210602173436](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20210602173436.png)

操作起来特别麻烦，会遇到上面提到的一系列问题。

**小结**

- 什么是开发环境？

我们用来写代码的电脑就是开发环境。

- 什么是生产环境？

生产环境就是服务器环境，也就是我们所写的程序最终要丢到上面运行的那个环境。

- 问：删除一个 10 GB 的文件 和 删除 10000 个 1 kb 的文件，哪个速度更快？

答：前者更快，看似它们所占的空间都差不多，但是后者文件数量太多了，如果把目录看做是一棵树的话，就相当于这棵树上存在10000个分支，处理完一个分支后还得跑到另一个分支去处理，速度自然就相对前者慢了许多。

- "开发环境中安装的大量的库如何在生产环境中还原？又如何区分哪些库是开发环境中所需要的，哪些库是生产环境中所需要的？"这句话描述了以下两个问题：

【问题1】假设，在开发环境下，我们实际需要用到的库只有10个，那我们上传到生产环境下，一般也就只有10个库嘛？

答：我们上传到生产环境，也许将会是上百个，上千个。比方说后面要学习的 Vue，它就依赖了一堆，虽然我们只要用 Vue，但是它的一堆依赖，我们也得一起算上。也就是说，我们执行 `npm install` 10次，下载下来的库很可能远大于10个。所以，我们在开发阶段下来下来的库，基本上都是不会上传到生产环境的。那么，为了让我们写的程序能够在生产环境中运行，我们就需要通过其他手段，在生产环境下还原我们在开发环境中所安装的库。【npm 可以帮我们解决这个库还原的问题。】

【问题2】有那么一些库，我们只有在开发环境中会用到，在生产环境就不需要它了。比如：mocha -> 用来测试的。【对于在生产环境中我们不需要使用到的库，如何处理的问题。】

**重点**

了解包管理器出现的原因。

理解起来也很简单，我们知道，模块化的出现，让我们能够更好的划分功能模块，每个模块只要实现一个小的功能片段即可。但是模块化也带来了一系列的问题，那就是文件变多了。之前没有模块化的时候，一堆代码都丢到一个或几个文件中，我们只管理这么几个文件，还是应付的过来的，但是如果数量变为上百个，而且它们之间还有复杂的依赖关系，那操作起来就会非常的繁琐，会带来一系列的问题。

简言之：有模块化，必然得有包管理。

## 3. 前端包管理器

**本门课程讲解的包管理器**

- npm：重点
- yarn：次重点
- 其他：了解

**npm 的概念**

几乎可以这样认为，前端所有的包管理器都是基于 npm 的，目前，npm 即是一个包管理器，也是其他包管理的基石。

npm 全称为 `node package manager`，即 node 包管理器，它运行在 node 环境中，让开发者可以用简单的方式完成包的查找、安装、更新、卸载、上传等操作。

npm 的出现，弥补了 node 没有包管理器的缺陷，于是很快，node 在安装文件中内置了 npm，当开发者安装好 node 之后，就自动安装了 npm，不仅如此，node 环境还专门为 npm 提供了良好的支持，使用 npm 下载的包更加方便了。

**npm 的组成**

- registry：入口
  - 可以把它想象成一个庞大的数据库
  - 第三方库的开发者，将自己的库按照 npm 的规范，打包上传到数据库中
  - 使用者通过统一的地址下载第三方包
- 官网：https://www.npmjs.com/
  - 查询包
  - 注册、登录、管理个人信息（如果想要分享自己写的东西给别人用，那得先注册登录，如果只是用别人的，不注册登录也可以用。）
- CLI：`command-line interface` 命令行接口
  - 这一部分是本门课讲解的重点
  - 安装好 npm 后，通过 CLI 来使用 npm 的各种功能

**小结**

- 这一部分为啥叫“前端包管理器”？

因为其他很多语言，都有自己的包管理工具，我们前端的JS也不例外，该课程要介绍的，主要也就是前端的包管理工具。

- npm 是什么？

npm 全称为 node package manager，即 node 包管理器，它运行在 node 环境中，让开发者可以用简单的方式完成包的查找、安装、更新、卸载、上传等操作。

PS：npm这家公司已经被Github收购了，Github是微软的，那npm也就是微软下的孙公司了。npm是用Java写的。

- npm 为什么要运行在 node 环境中？

npm 之所以要运行在 node 环境，而不是浏览器环境，根本原因是因为**浏览器环境无法提供下载、删除、读取本地文件的功能**。而 node 属于服务器环境，没有浏览器的种种限制，理论上可以完全掌控运行 node 的计算机。

- npm由哪几部分组成？

registry、官网：https://www.npmjs.com/ 、CLI

- 什么是 CLI？

command-line interface 命令行接口。

- 简单认识一下 npm 官网的界面。

![20210602183833](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20210602183833.png)

![20210602183953](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20210602183953.png)

![20210602184348](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20210602184348.png)

![20210602185511](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20210602185511.png)

- 什么是 power shell？

参考文章：https://docs.microsoft.com/zh-cn/powershell/scripting/overview?view=powershell-7.1

PS：内容有些多，有需要的话再深入了解一下，现阶段我们要知道的就是，我们是在 power shell 环境下写命令的。

- 如何打开 power shell？

![20210602190342](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20210602190342.png)

- 方式1：按 windows 键，输入 power

![20210602190320](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20210602190320.png)

- 方式2：Alt + 空格，打开 utools 软件，输入 powershell

![20210602190442](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20210602190442.png)

PS：得先安装软件 utools

- 方式3：在 vscode 中打开 powershell，按 Ctrl + J

![20210602190551](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20210602190551.png)

- 如何查看当前的 npm 版本？

`npm -v`（缩写） 或 `npm --version`（完整命令）

![20210602190655](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20210602190655.png)

后面学习的很多命令，我们通常都会使用缩写的形式，但是，要知道，其实它们都是有全称的（即：完整版本）。比如：安装包 `npm -i 包名` 是简写；`npm --install 包名` 是完整命令。

- node 和 npm 的关系。

我的理解是：node 的出现，实现了模块化规范 CommonJS 这一社区规范，让 JS 走向了模块化，然后包管理器 npm 就火了。npm 火了之后，很多大佬就借助 npm 来分享库。这些库有得在 node 环境中运行，然后 node 就更火了。综上，可以认为它们是相互成就的。