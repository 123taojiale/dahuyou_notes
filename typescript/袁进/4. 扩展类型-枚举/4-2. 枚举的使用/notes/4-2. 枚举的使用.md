## 4-2. 枚举的使用

### 前言

- 时长：20min

学习约束某个变量的取值范围的最佳实践 - 使用枚举。

### Syntax

```ts
enum 枚举名 {
  枚举字段1 = 值1,
  枚举字段2 = 值2,
  ...
}
```

### Attention

- 枚举会出现在编译结果中，编译结果中表现为一个对象；
- 枚举的字段值可以是字符串或数字；
- 数字枚举的值会自动自增；
- 被数字枚举约束的变量，可以直接赋值为数字；
- 数字枚举的编译结果和字符串枚举有差异；


### Best Practices

- 尽量不要在一个枚举中，即出现字符串字段，又出现数字字段；
- 使用枚举式，尽量使用枚举字段的名称，而不使用真实的值；

### codes

- [ ] 1.ts

```ts
enum Gender {
  male = "男",
  female = "女",
}

let gender: Gender;

gender = Gender.male;

function searchUsers(g: Gender) {}
/*
枚举的写法
male 和 female 是逻辑名称，它们映射的值，是真实展示给用户看的值。
我们在写的时候，写的是逻辑名称，比如：Gender.male 但是读取到的，是真实的值。
*/
```

**认识一下枚举的图标**

![20211112113007](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20211112113007.png)

**一键重命名**

我们通常遇到的需求，修改的都是展示给用户看的值，一般不会有需求是改变逻辑含义的。但是，若我们需要修改逻辑名，也是可以一键修改的，在指定的逻辑名上右键，选择重命名符号即可修改。（或直接按 F2）

![20211112120059](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20211112120059.png)

**编译结果分析**

```js
// 编译结果
var Gender;
(function (Gender) {
    Gender["Male"] = "\u7537";
    Gender["female"] = "\u5973";
})(Gender || (Gender = {}));
let gender;
gender = Gender.Male;
function searchUsers(g) { }
```

在编译结果中，枚举 Gender 会被识别为一个对象。

> 由于我们使用到了中文，会进行 Unicode 编码：
> - “男” 对应的 Unicode 编码是 \u7537
> - “女” 对应的 Unicode 编码是 \u5973

```js
var Gender;
(function (Gender) {
    Gender["Male"] = "\u7537";
    Gender["female"] = "\u5973";
})(Gender || (Gender = {}));
// 等价于：
var Gender {
  Male: "男",
  female: "女"
}
```

- [ ] 2.ts

```ts
enum Gender {
  Male = "男",
  female = "女",
}

function printGenders() {
  const vals = Object.values(Gender);
  vals.forEach((v) => console.log(v));
}
printGenders();
```

在编译结果中，我们也可以获取到 Gender 中定义的真实值。

- [ ] 3.ts

```ts
enum Level {
  level1 = 1,
  level2 = 2,
  level3 = 3,
}

let l: Level = Level.level1;
l = Level.level2;
/*
枚举的字段值可以是字符串或数字；
*/
```

编译结果分析

```js
// 编译结果
var Level;
(function (Level) {
    Level[Level["level1"] = 1] = "level1";
    Level[Level["level2"] = 2] = "level2";
    Level[Level["level3"] = 3] = "level3";
})(Level || (Level = {}));
let l = Level.level1;
l = Level.level2;
```

数字枚举的编译结果和字符串枚举是有差异的：

```js
(function (Level) {
    Level[Level["level1"] = 1] = "level1";
    Level[Level["level2"] = 2] = "level2";
    Level[Level["level3"] = 3] = "level3";
})(Level || (Level = {}));
// 相当于生成了下面这样一个对象
{
  level1: 1,
  level2: 2,
  level3: 3,
  "1": "level1",
  "2": "level2",
  "3": "level3",
}
```

- [ ] 4.ts

```ts
enum Level {
  level1 = 1,
  level2, // 相当于写了 level2 = 2,
  level3, // 相当于写了 level3 = 3,
}

let l: Level = Level.level1;
l = Level.level2;
/*
数字枚举的值会自动自增；
这种 4.ts 中的代码，和 3.ts 中的代码，是完全等效的。
*/
```

**枚举字段值都为空**

若枚举字段的值，都没有填写，那么默认是数字枚举，并且起始字段的值为 0。

```ts
enum Level {
  level1, // 相当于写了 level2 = 0,
  level2, // 相当于写了 level2 = 1,
  level3, // 相当于写了 level3 = 2,
}
```

- [ ] 5.ts

```ts
enum Level {
  level1,
  level2,
  level3,
}

let lev: Level = 1; // 不会报错
lev = 2; // 不会报错
/*
被数字枚举约束的变量，可以直接赋值为数字；
但是，不推荐这么写。
*/
```

