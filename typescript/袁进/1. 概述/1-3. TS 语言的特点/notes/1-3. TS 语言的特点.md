## 1-3. TS 语言的特点 {ignore}

[toc]

### 前言

- 时长：29min

### What is TypeScript？

概念：
- TypeScript 是 JS 的**超集**，是一个**可选**的、**静态**的**类型系统**。（袁老给的定义）
- TypeScript 是面向对象的 JavaScript。
- TypeScript 是 JavaScript 的超集，具有可选的类型并**可以编译为纯 JavaScript**。
- TypeScript is a strongly typed programming language that builds on JavaScript, giving you better tooling at any scale.
  译：TypeScript 是一种基于 JavaScript 的强类型编程语言，它可以在任意规模的项目中，为您提供更好的工具。

> 网上对 typescript 是什么的定义有很多，以上记录的几点是比较常见的一些定义。
> 最后一个是来自 [ts官方](https://www.typescriptlang.org/) 的定义。

下面这张图来自于 [ts官网](https://www.typescriptlang.org/) 首页：

![20211107164709](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20211107164709.png)

译：
- TypeScript 向 JavaScript 添加了额外的语法，以支持与您的**编辑器更紧密的集成。在编辑器中尽早发现错误**。
- TypeScript 代码转换为 JavaScript，**只要是 JavaScript 可以运行的地方，它都能运行**：在浏览器中、Node.js 或 Deno 中以及您的应用程序中。
- TypeScript 理解 JavaScript 并使用类型推断为您提供出色的工具，而无需额外的代码。

注解：
- 超集：这是数学中的概念，可理解为 ts 包含 js。
- 可选：表示我们在写 ts 代码时，完全可以按照之前写 js 代码的形式来写，ts 给我们提供的功能，我们可以选用。当然，不用也是完全 OK 的，并不会报错。
- 静态：指变量的数据类型不可变，这一点和 js 是完全不同的。所以，无论是浏览器环境，还是 node 环境，它们都能直接识别 js 代码，但是无法直接识别 ts 代码。
- 类型系统：对代码中所有的标识符（变量、函数、参数、返回值）进行类型检查。**类型检查发生的时间，是在编译的时候，而非代码运行的时候**。TS 不参与任何运行时的类型检查。

TS 和 JS 的关系：
![20211107203643](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20211107203643.png)

有关 TS 的一些常识：
- TS 是微软在 2012 年发布的。
- 由 Anders Hejlsberg 负责开发 TS 项目。
- 开源、拥抱 ES 标准。
- 版本：4.4（当前时间 2021年11月7日 的最新版）
  - 视频录制时是 19 年 4 月，当时版本是 3.4。
- 官网：http://www.typescriptlang.org/

> 中文网：https://www.tslang.cn/
> 这个中文网是个人翻译的，里边有一些翻译不是很准确，若有阅读外文文档的能力，最好还是去看[官网](http://www.typescriptlang.org/)。

### 体验 ts

```js
// 1.js => 上节课的问题代码
function getUserName() {
  if (Math.random() < 0.5) {
    return "da hu you";
  }
  return 404;
}

let myname = getUsername();

mynema = myname.split(" ")
  .filter(it => it)
  .map(it => it[0].touppercase() + it.subStr(1))
  .join("");
```

我们将文件 1.js 重命名为 1.ts。会发现它会将我们代码中，这些明显出错的地方标注出来。如下图所示：

![20211107155443](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20211107155443.png)

```ts
// ts 提示我们函数名写错了，修改一下函数名：
function getUserName() {
  if (Math.random() < 0.5) {
    return "da hu you";
  }
  return 404;
}

let myname = getUserName();

mynema = myname.split(" ")
  .filter(it => it)
  .map(it => it[0].touppercase() + it.subStr(1))
  .join("");
```

修改好函数名后，我们再来看 ts 帮我们定位到的下一个问题：

![20211107155710](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20211107155710.png)

```ts
// 修改变量名
function getUserName() {
  if (Math.random() < 0.5) {
    return "da hu you";
  }
  return 404;
}

let myname = getUserName();

myname = myname.split(" ")
  .filter(it => it)
  .map(it => it[0].touppercase() + it.subStr(1))
  .join("");
```

![20211107155810](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20211107155810.png)

```ts
// ts 告诉我们 myname 的类型有可能是 string | number，但是 number 类型上不存在 split 方法。
// 我们只要在执行这段程序之前做一个类型检测即可：
function getUserName() {
  if (Math.random() < 0.5) {
    return "da hu you";
  }
  return 404;
}

let myname = getUserName();

if (typeof myname === "string") {
  myname = myname.split(" ")
    .filter(it => it)
    .map(it => it[0].touppercase() + it.subStr(1))
    .join("");
}
```

![20211107160025](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20211107160025.png)

```ts
// 修改方法名
function getUserName() {
  if (Math.random() < 0.5) {
    return "da hu you";
  }
  return 404;
}

let myname = getUserName();

if (typeof myname === "string") {
  myname = myname.split(" ")
    .filter(it => it)
    .map(it => it[0].toUpperCase() + it.subStr(1))
    .join("");
}
```

![20211107160116](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20211107160116.png)

```ts
// 修改方法名
function getUserName() {
  if (Math.random() < 0.5) {
    return "da hu you";
  }
  return 404;
}

let myname = getUserName();

if (typeof myname === "string") {
  myname = myname.split(" ")
    .filter(it => it)
    .map(it => it[0].toUpperCase() + it.substr(1))
    .join("");
}
```

最终代码如下：

```js
// 1.ts
function getUserName() {
  if (Math.random() < 0.5) {
    return "da hu you";
  }
  return 404;
}

let myname = getUserName();

if (typeof myname === "string") {
  myname = myname
    .split(" ")
    .filter((it) => it)
    .map((it) => it[0].toUpperCase() + it.substr(1))
    .join("");
}
```

### Globally Installing TypeScript

You can use npm to install TypeScript globally, this means that you can use the `tsc` command anywhere in your terminal.

```shell
npm install -g typescript
```

- what is `tsc`?

tsc 的全称为 typescript compiler，它是 typescript 的编译器，可以将我们写的 ts 代码给转换为 js 代码。

- how to use `tsc`?

```shell
tsc 1.ts # 将当前目录的 1.ts 文件给编译为 1.js
```

![20211107203231](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20211107203231.png)

![20211107203239](https://cdn.jsdelivr.net/gh/123taojiale/dahuyou_picture@main/blogs/20211107203239.png)

> 我们会发现，这样编译之后，原来的 1.ts 文件会出现报错信息，暂且先别管这些错误信息，以及编辑后生成的 1.js 文件的内容，后边会介绍为什么。

### 额外的惊喜

我们仅仅是将后缀名改为 `.ts`，它就能帮我们定位到这些低级的错误。好让我们提前将这些错误给排除，单单是这一点功能，我们就有学习 ts 的必要。除此之外，它还给我们带来的一些额外的惊喜：**完善了 js 的面向对象开发**。

由于有了类型检查，增强了 js 面向对象的开发。js 中也有类和对象，它本身也是支持面向对象的开发方式的，但是由于 js 自身是没有类型检查的，这就导致很多面向对象的场景实现起来会出现诸多问题。所以，直接使用 js 实现面向对象，还不是很完善。但是，ts 出现后，我们就可以利用它编写出更加完善的面向对象的代码。